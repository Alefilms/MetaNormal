// main global script file
DynamicSprite *buttonSprite; 
int dlg_opt_color = 14;
int dlg_opt_acolor = 5;
int dlg_opt_ncolor = 0;

// called when the game starts, before the first room is loaded
function game_start() 
{
  BCerrarInventario.Visible = false;
}
//CODIGO PARA COMPROBRAR PARTIDAS PARA GUARDAR
//---------------------------------------------------------------------//
// Busca las partidas existentes
int BuscaPartidas(String nombre)
{
  bool partidas[] = new bool[999];
  int i = 0;
  while (i < ListaDeGuardado.ItemCount)
  {
    if (ListaDeGuardado.Items[i] == nombre)
    {
      //  Busca una partida existente con que coicida con el nombre
      return ListaDeGuardado.SaveGameSlots[i];
    }
    // Recuerda las partidas que ya estan tomas
    partidas[ListaDeGuardado.SaveGameSlots[i]] = true;
    i++;
  }
 
  // Busca el primer casillero libre, empezando con el casillero  1
  i = 1;
  while (i < 999)
  {
    if (!partidas[i])
      return i;
    i++;
  }
  // Si no hay casilleros libres
  return -1;
}

// Muestra las partidas existentes
function MuestraDialogoDeGuardado()
{
  gGuardar.Visible = true;
  // Muestra la lista de guardados
  ListaDeGuardado.FillSaveGameList();
  // Si hay al menos una partida
  if (ListaDeGuardado.ItemCount > 0)
  {
     // Muestra la imagen de la partida  
 
       int PartidaGuardada = ListaDeGuardado.SaveGameSlots[ListaDeGuardado.SelectedIndex];

      buttonSprite = DynamicSprite.CreateFromSaveGame(PartidaGuardada, 500, 281);

        if (buttonSprite != null) 
          {
            BScreenShot.NormalGraphic = buttonSprite.Graphic;
          }
       
    TxtNuevoGuardado.Text = ListaDeGuardado.Items[0];
  }
  else
  {
    buttonSprite = null;
    // Si no hay partidas que muestre el texto vacio
    TxtNuevoGuardado.Text = "";
  }
  mouse.UseModeGraphic(eModePointer);

}
//CODIGO PARA COMPROBRAR PARTIDAS PARA CARGAR
//---------------------------------------------------------------------//
function MuestraDialogoDeCargado()
{
  gCargar.Visible = true;
  ListaDeCargado.FillSaveGameList();
  mouse.UseModeGraphic(eModePointer);
  
  if (ListaDeCargado.ItemCount > 0)
  {
     // Muestra la imagen de la partida  
 
     int PartidaGuardada = ListaDeCargado.SaveGameSlots[ListaDeCargado.SelectedIndex];

      buttonSprite = DynamicSprite.CreateFromSaveGame(PartidaGuardada, 500, 281);

if (buttonSprite != null) 
    {
      BScreenShotCargado.NormalGraphic = buttonSprite.Graphic;
    }
  }

}
 // Codigo para que aparezcan los nombres de los hotspots cuando para el cursor por encima
function QueAparezcanLosNombresDeLosHospots ()
  {
    int CoordenadaX = mouse.x+3; // Coordenadas de X del mouse + 3 
    int CoordenadaY = mouse.y-35;// Coordenadas de Y del mouse + 15
    GUI*g = gMuestraHotspots; 
                                  // Para que se mantengan el los limites de la pantalla
    if (CoordenadaX > 1280-g.Width)
      {
        CoordenadaX  = 1280-g.Width;
      }
    if (CoordenadaY > 720-g.Height) 
      {
        CoordenadaY = 720-g.Height;
      }
      
   g.SetPosition(CoordenadaX,  CoordenadaY);  // Posiciona el GUI que muestra los hospots en las coordenadas actuales del mouse
 } 
// put anything you want to happen every game cycle in here
function repeatedly_execute() 
{
QueAparezcanLosNombresDeLosHospots();  

}

// put here anything you want to happen every game cycle, even when the game is blocked
function repeatedly_execute_always() 
{
 
}

// called when a key is pressed. keycode holds the key's ASCII code
function on_key_press(eKeyCode keycode) 
{
  if (IsGamePaused()) keycode = 0; // game paused, so don't react to keypresses
  
  if (keycode == eKeyCtrlQ) QuitGame(1); // Ctrl-Q
  if (keycode == eKeyF9) RestartGame(); // F9
  if (keycode == eKeyF12) SaveScreenShot("scrnshot.pcx");  // F12
  if (keycode == eKeyCtrlS) Debug(0,0); // Ctrl-S, give all inventory
  if (keycode == eKeyCtrlV) Debug(1,0); // Ctrl-V, version
  if (keycode == eKeyCtrlA) Debug(2,0); // Ctrl-A, show walkable areas
  if (keycode == eKeyCtrlX) Debug(3,0); // Ctrl-X, teleport to room
 // if (keycode == eKey6) Display(" %d.", player.Scaling); testeo de escala en la room
  
  // Guarda rapido la partida con F5
  if (keycode == eKeyF5)
   
   if (player.Room == 4)
      {
        
      }
   else 
   {
    SaveGameSlot(99,"Guardado Rapido");
    gGuardadoRapido.Visible = true;
     int transGuardado = gGuardadoRapido.Transparency;
     while (transGuardado > 20 ) 
     {
       transGuardado -= 2;
       gGuardadoRapido.Transparency = transGuardado;
       Wait(1);
     }
       while (transGuardado < 70 ) 
     {
       transGuardado += 2;
       gGuardadoRapido.Transparency = transGuardado;
       Wait(1);
       
        if ( transGuardado == 70)
        {
          gGuardadoRapido.Visible = false;
        }
     }
  }
  
   // Carga rapido la partida con F5
  if (keycode == eKeySpace)
  {
    RestoreGameSlot(99);
  }
  // Cerrar el gui de guardar
  if ((keycode == eKeyEscape) && (gGuardar.Visible == true))
  {
    gGuardar.Visible = false;
  }
  // Cerrar el gui de Cargar
   if ((keycode == eKeyEscape) && (gCargar.Visible == true))
  {
    gCargar.Visible = false;
  }
  // Abrir el menu aprentando Escape----------------------
  if (keycode == eKeyEscape)
  {
  
    int transMenu = gMenu.Transparency;
    int transFade =gFade.Transparency;
     if (gConfirmacionDeSalir.Visible == true)
       {
         gConfirmacionDeSalir.Visible = false;
       }
      
      if (player.Room == 4)
      {
        
      }
         // Hacer visible el menu----------------------
    else if ( gMenu.Visible == false)
    {
         mouse.Mode = eModePointer;
      gMenu.Visible = true;
      gFade.Visible = true;
        while (transMenu > 20 ) 
        {
            
          transMenu-= 2;
          transFade-= 2;
          gMenu.Transparency = transMenu;
          gFade.Transparency = transFade;
          Wait(1);
        }
    }
         // Hacer invisible el menu------------------------
      else if ( gMenu.Visible == true)
       {
          
     
        while (transMenu < 70 ) 
        {
          transMenu+= 2;
          transFade+= 2;
          gMenu.Transparency = transMenu;
          gFade.Transparency = transFade;
          Wait(1);
            if (transMenu == 70)
            {
              gMenu.Visible = false;
              gFade.Visible = false;
           mouse.Mode = eModeWalkto;
            }
        }
       }

   
  }

}

function on_mouse_click(MouseButton button) // called when a mouse button is clicked. button is either LEFT or RIGHT
{
  if (IsGamePaused() == 1) // Game is paused, so do nothing (ie. don't allow mouse click)
  {
  }
  else if (button == eMouseLeft) 
  {
    Room.ProcessClick(mouse.x,mouse.y, mouse.Mode);
  }
  else // right-click, so cycle cursor
  {   
    mouse.SelectNextMode();
  }
}


function dialog_request(int param) {
}
//-------FUNCIONES PARA GENERAR GLOBOS DE TEXTO-----------------------//
// Codigo para que hablen los pjs en general(dialogo igual para todos)
function Hablar (String Loquedice)
{
  short palabras = Loquedice.Length; // Que tan largo es el texto
  short Ancho;                // El ancho de la burbuja a crear
  short PosicionY;            //La posicion en Y de la burbuja  
  short PosicionX;            // La posicion en X de la burbuja 
   SetTextWindowGUI(10);      // Que la flecha de la burbuja este a la izquierda
  PosicionY =  player.y - (230 *player.Scaling)/100 - (palabras) - GetViewportY() ; // Calculo por default de Y
  PosicionX = player.x + (25*player.Scaling)/100 - GetViewportX() ;// Calculo por default de X
  
   if (palabras > 40) // Si la cantidad de caracteres es mayor a 40
  {
   Ancho = 250;
  }
  else if ((palabras <= 40 && palabras > 20 )) // Si la cantidad de caracteres es menor a 40 y mayor a 20
  { 
   Ancho = 200;
  }
  else if ((palabras <= 20 && palabras > 0 )) // Si la cantidad de caracteres es menor a 20 y mayor a 0
  {
   Ancho = 150;
  }
  if (player.Loop == 0)  // Si se encuentra el pj se encuentra mirando hacia abajo
  {
    PosicionX = player.x + 5 - GetViewportX() ; 
  }

  if (player.Loop == 1)   // Si se encuentra el pj se encuentra mirando hacia la izquierda
  {
    SetTextWindowGUI(11);
    PosicionX = player.x - (25*player.Scaling)/100 - Ancho - 30 - GetViewportX() ;
  }
  if (player == cAle) // Si el PJ principal es Ale
   {                     // Animacion para que hable dependiendo donde este mirando 
     player.LockView(11);  
     if (player.Loop == 0)
      {
      player.Animate(0, 5, eRepeat, eNoBlock);
      }
      if (player.Loop == 1)
      {
      player.Animate(1, 5, eRepeat, eNoBlock);
      }
      if (player.Loop == 2)
      {
      player.Animate(2, 5, eRepeat, eNoBlock);
      }
      
    }
     if (player == cSantiago)  // Si el PJ principal es Santiago
   {           
      
      if (CharlandoPorCelu == true) // Si habla por celular, animacion hablando por telefono
      {
        player.LockView(16);
         if (player.Loop == 1)
          {
          player.Animate(1, 5, eRepeat, eNoBlock);
          }
          else
          {
            player.Animate(0, 5, eRepeat, eNoBlock);
          }
      }
      else // Si no esta hablando por celular, animacion para que hable dependiendo donde este mirando  
      {
          
        player.LockView(12);
         if (player.Loop == 0)
          {
          player.Animate(0, 5, eRepeat, eNoBlock);
          }
          if (player.Loop == 1)
          {
          player.Animate(1, 5, eRepeat, eNoBlock);
          }
          if (player.Loop == 2)
          {
          player.Animate(2, 5, eRepeat, eNoBlock);
          }
       }
    }
   
  player.SayAt(PosicionX, PosicionY, Ancho, Loquedice); // La funcion que hace hablar 
  if (CharlandoPorCelu == true)
  {
    if (player.Loop == 1)
          {
            player.LockViewFrame(16, 1, 0);
          }
          else
          {
            player.LockViewFrame(16, 0, 0);
          }
  }
  else
  {
    player.UnlockView();  // Para parar la animacion normal
  }
}
// Codigo para que hable Santiago
function HablarSantiago (String Loquedice)
{
  short palabras = Loquedice.Length;
  short Ancho;
  short PosicionY; 
  short PosicionX;
   SetTextWindowGUI(10);
   PosicionY = cSantiago.y  - (230 *cSantiago.Scaling)/100 - (palabras) - GetViewportY() ;
  PosicionX = cSantiago.x + (25*cSantiago.Scaling)/100 - GetViewportX() ;
  
   if (palabras > 40)
  {
  Ancho = 250;
  }
  else if ((palabras <= 40 && palabras > 20 ))
  {
  Ancho = 200;
  }
  else if ((palabras <= 20 && palabras > 0 ))
  {
     Ancho = 150;
  }
  if (cSantiago.Loop == 0)
  {
    PosicionX = cSantiago.x + 5 - GetViewportX() ; 
  }

  if (cSantiago.Loop == 1)
  {
    SetTextWindowGUI(11);
    PosicionX = cSantiago.x - (25*cSantiago.Scaling)/100 - Ancho - 30 - GetViewportX() ;
  }
  
      cSantiago.LockView(12);
       if (cSantiago.Loop == 0)
        {
        cSantiago.Animate(0, 5, eRepeat, eNoBlock);
        }
        if (cSantiago.Loop == 1)
        {
        cSantiago.Animate(1, 5, eRepeat, eNoBlock);
        }
        if (cSantiago.Loop == 2)
        {
        cSantiago.Animate(2, 5, eRepeat, eNoBlock);
        }
  cSantiago.SayAt(PosicionX, PosicionY, Ancho, Loquedice);
  cSantiago.UnlockView();
}
// Codigo para que hable Ale
function HablarAle (String Loquedice)
{
  short palabras = Loquedice.Length;
  short Ancho;
  short PosicionY; 
  short PosicionX;
   SetTextWindowGUI(10);
   PosicionY = cAle.y  - (230 *cAle.Scaling)/100 - (palabras) - GetViewportY() ;
  PosicionX = cAle.x + (25*cAle.Scaling)/100 - GetViewportX() ;
  
   if (palabras > 40)
  {
  Ancho = 250;
  }
  else if ((palabras <= 40 && palabras > 20 ))
  {
  Ancho = 200;
  }
  else if ((palabras <= 20 && palabras > 0 ))
  {
     Ancho = 150;
  }
  if (cAle.Loop == 0)
  {
    PosicionX = cAle.x + 5 - GetViewportX() ; 
  }

  if (cAle.Loop == 1)
  {
    SetTextWindowGUI(11);
    PosicionX = cAle.x - (25*cAle.Scaling)/100 - Ancho - 30 - GetViewportX() ;
    
  }
  
        if (cAle.Room == 5)
        {
          
        }
        else
        {
           cAle.LockView(11);  
           if (cAle.Loop == 0)
            {
            cAle.Animate(0, 5, eRepeat, eNoBlock);
            }
            if (cAle.Loop == 1)
            {
            cAle.Animate(1, 5, eRepeat, eNoBlock);
            }
            if (cAle.Loop == 2)
            {
            cAle.Animate(2, 5, eRepeat, eNoBlock);
            }
        }
    
  cAle.SayAt(PosicionX, PosicionY, Ancho, Loquedice);
        if (cAle.Room == 5)
        {
          
        }
        else
        {
          cAle.UnlockView();
          }
}
//-------------------------------------------------------//

function HablarDefault ()
{
  Hablar("Dudo que me conteste si le hablo");
}

function HablarCosa (String Loquedice)
{ 
if (CharlandoPorCelu == true) // Si se esta hablando por celular
{
  short palabras = Loquedice.Length; 
  short Ancho;               
  short PosicionY;           
  short PosicionX;           
   SetTextWindowGUI(17); // GUI para hablar a traves de un externo    
  PosicionY =  player.y - (230 *player.Scaling)/100 - (palabras) - GetViewportY() ; // Calculo por default de Y
  
      if (palabras > 40)
  {
  Ancho = 250;
  }
  else if ((palabras <= 40 && palabras > 20 ))
  {
  Ancho = 200;
  }
  else if ((palabras <= 20 && palabras > 0 ))
  {
     Ancho = 150;
  }
  PosicionX = player.x + (25*player.Scaling)/100 - GetViewportX() ;
     
   
    if (player.Loop == 1)   // Si se encuentra el pj se encuentra mirando hacia la izquierda
    {
      PosicionX = player.x - (25*player.Scaling)/100 - Ancho - 30 - GetViewportX() ;
    }
  cCosa.SayAt( PosicionX, PosicionY, Ancho, Loquedice);  
}
else
{
 cCosa.SayBackground(Loquedice);  // El default
}
 }
// Boton para subirr en el inventario
function BFlechaArriba_OnClick(GUIControl *control, MouseButton button)
{
InventoryWindow1.ScrollUp();
}
// Boton para bajar en el inventario
function BFlechaAbajo_OnClick(GUIControl *control, MouseButton button)
{
InventoryWindow1.ScrollDown();
}
// Boton para abrir el inventario
function BAbrirInventario_OnClick(GUIControl *control, MouseButton button)
{
 if (gInventario.Visible == false)
 {
  gInventario.Visible = true;
  BAbrirInventario.Visible = false;
  BCerrarInventario.Visible = true;
 }
}
// Boton para cerrar el inventario
function BCerrarInventario_OnClick(GUIControl *control, MouseButton button)
{
if (gInventario.Visible == true)
 {
  gInventario.Visible = false;
  BCerrarInventario.Visible = false;
  BAbrirInventario.Visible = true;
 }

}
// Boton del menu para resumir la partida
function BResumir_OnClick(GUIControl *control, MouseButton button)
{
  int transMenu = gMenu.Transparency;
  int transFade = gFade.Transparency; 
if ( gMenu.Visible == true)
       {
        while (transMenu < 70 ) 
        {
          transMenu++;
          transFade++;
          gMenu.Transparency = transMenu;
          gFade.Transparency = transFade;
          Wait(1);
            if (transMenu == 70)
            {
              gMenu.Visible = false;
              gFade.Visible = false;
            }
        }
       }
}

// Boton para si salir del juego
function BSi_OnClick(GUIControl *control, MouseButton button)
{
QuitGame(0);
}
// Boton para no salir del juego
function BNo_OnClick(GUIControl *control, MouseButton button)
{
gConfirmacionDeSalir.Visible = false;
}
// Boton del menu que muestra el gui para confirmar salir del juego
function BSalir_OnClick(GUIControl *control, MouseButton button)
{
gConfirmacionDeSalir.Visible = true;
}
// Boton del menu de Inicio que muestra el gui para confirmar salir del juego
function BSalirInicio_OnClick(GUIControl *control, MouseButton button)
{
gConfirmacionDeSalir.Visible = true;
}
// Boton del menu de Inicio para comenzar una nueva partida
function BNuevaPartida_OnClick(GUIControl *control, MouseButton button)
{
gMenuInicio.Visible = false;
player.ChangeRoom(1 ); // 5,1000, 460 
}
//---------BOTONES PARA GUARDAR PARTIDA--------//
// Muestra el gui de guardar partida desde el menu de inicio
function BGuardarMenu_OnClick(GUIControl *control, MouseButton button)
{
MuestraDialogoDeGuardado();
}
// Guarda la partida
function BGuardar_OnClick(GUIControl *control, MouseButton button)
{
   int LugarAGuardarPartida = BuscaPartidas(TxtNuevoGuardado.Text);
  if (LugarAGuardarPartida < 0)
  {
    return;
  }
gGuardar.Visible = false;
gMenu.Transparency = 70;
gFade.Transparency = 100;
gFade.Visible = false;
gMenu.Visible = false;
Wait(1);
SaveGameSlot(LugarAGuardarPartida, TxtNuevoGuardado.Text);
} 
// Cancela el guardado
function BCancelarGuardado_OnClick(GUIControl *control, MouseButton button)
{
gGuardar.Visible = false;
}
// Borra la partida
function BBorrar_OnClick(GUIControl *control, MouseButton button)
{
  if (ListaDeGuardado.SelectedIndex >= 0)
  {
    DeleteSaveSlot(ListaDeGuardado.SaveGameSlots[ListaDeGuardado.SelectedIndex]);
    ListaDeGuardado.FillSaveGameList();
  }
}
// Guarda la partida si aprentamos enter una vez despues de escribir
function TxtNuevoGuardado_OnActivate(GUIControl *control)
{
BGuardar_OnClick(control, eMouseLeft);
}
// Muestra en el TXT y la imagen la partida seleccionada 
function ListaDeGuardado_OnSelectionChanged(GUIControl *control)
{
TxtNuevoGuardado.Text = ListaDeGuardado.Items[ListaDeGuardado.SelectedIndex];
   
   int PartidaGuardada = ListaDeGuardado.SaveGameSlots[ListaDeGuardado.SelectedIndex];

      buttonSprite = DynamicSprite.CreateFromSaveGame(PartidaGuardada, 500, 281);

if (buttonSprite != null) 
    {
      BScreenShot.NormalGraphic = buttonSprite.Graphic;
    }


//---------BOTONES PARA CARGAR PARTIDA--------//

}
// Muestra el gui para cargar desde el Menu 
function BCargarMenu_OnClick(GUIControl *control, MouseButton button)
{
MuestraDialogoDeCargado();
}
// Muestra el gui para cargar desde el Menu de Inicio
function BCargarPartidaInicio_OnClick(GUIControl *control, MouseButton button)
{
MuestraDialogoDeCargado();
}
// Carga la partida
function BCargar_OnClick(GUIControl *control, MouseButton button)
{

  if (ListaDeCargado.SelectedIndex >= 0)
  {
    RestoreGameSlot(ListaDeCargado.SaveGameSlots[ListaDeCargado.SelectedIndex]);
  }
}
// Cancela el cargado 
function BCancelarCargado_OnClick(GUIControl *control, MouseButton button)
{
gCargar.Visible = false;
}
// Muestra en el TXT y la imagen la partida seleccionada para cargar
function ListaDeCargado_OnSelectionChanged(GUIControl *control)
{
   int PartidaGuardada = ListaDeCargado.SaveGameSlots[ListaDeCargado.SelectedIndex];

      buttonSprite = DynamicSprite.CreateFromSaveGame(PartidaGuardada, 500, 281);

if (buttonSprite != null) 
    {
      BScreenShotCargado.NormalGraphic = buttonSprite.Graphic;
    }
}
//--------------FUNCIONES PARA CREAR LAS OPCIONES DE DIALOGO--------------//
// Codigo pra crear las dimensiones y posicion del dialogo
function dialog_options_get_dimensions(DialogOptionsRenderingInfo *info)
{
short CantidadDeOpciones = info.DialogToRender.OptionCount; // Cantidad de opciones del dialogo
  if (player.x <= 470) // Si el personaje esta parado cerca del borde izquierdo
  {
   info.X = player.x + (25*player.Scaling)/100 - GetViewportX() ; // Posiciona el dialogo en X por a la derecha
    if (player.y >= 375 ) // Si el personaje no esta cerca del borde de arriba
      {
      info.Y = player.y - (300 *player.Scaling)/100 - 100 - GetViewportY() ; // Posiciona el dialogo en Y por arriba de la cabeza del pj
      }
      else // Si el personaje esta cerca del borde de arriba
      {
         info.Y = player.y - (300 *player.Scaling)/100 - GetViewportY() ; // Posiciona el dialogo en Y por abajo de la cabeza del pj
      }
      info.Width = 250; // Lo ancho del dialogo
      info.Height = CantidadDeOpciones*25 + 70; // Lo alto del dialogo
  }
  else // Si el personaje esta parado cerca del borde derecho
  {
    info.X = player.x - (25*player.Scaling)/100 - 250 - GetViewportX() ; // Posiciona el dialogo en X por a la izquierda
    if (player.y >= 375 )
      {
      info.Y = player.y - (300 *player.Scaling)/100 - 100 - GetViewportY() ;
      }
      else
      {
        info.Y = player.y - (300 *player.Scaling)/100 - GetViewportY() ;
      }

   info.Width = 250;
   info.Height = CantidadDeOpciones*25 + 70;
  }
 
  info.HasAlphaChannel = true; // Habilita transparencia

  
}

// Codigo para crear la burbuja pensante
function dialog_options_render(DialogOptionsRenderingInfo *info)
{
  short CantidadDeOpciones = info.DialogToRender.OptionCount; // Cantidad de opciones del dialogo
 
DrawingSurface *surface = Room.GetDrawingSurfaceForBackground();
 if (player.x <= 470) // Si el personaje esta parado cerca del borde izquierdo
  {
 info.Surface.DrawImage(0, 0, 198, 0, 250, CantidadDeOpciones*25 +70 ); // Dibuja la burbuja con las bubujitas a la derecha
surface.Release();
 }
  else // Si el personaje esta parado cerca del borde derecho
  {
     info.Surface.DrawImage(0, 0, 199, 0, 250, CantidadDeOpciones*25 +70 ); // Dibuja la burbuja con las bubujitas a la izquierda
surface.Release();
  }
  int i = 1,  ypos = 0;
  // Codigo para renderizar las opciones
  while (i <= info.DialogToRender.OptionCount)
  {
    if (info.DialogToRender.GetOptionState(i) == eOptionOn)
    {
      if (info.ActiveOptionID == i) 
      {  
        info.Surface.DrawingColor = dlg_opt_acolor; //Dibuja la opcion que se esta señalando en violeta
      }
       else if (info.DialogToRender.HasOptionBeenChosen(i))
       {
         game.read_dialog_option_color = 7; // Si la opcion fue elegida la cambia a gris
        info.Surface.DrawingColor = game.read_dialog_option_color ;
       }
      else
      {
        info.Surface.DrawingColor = dlg_opt_ncolor; // Si no paso nada la dibuja en negro
      } 
       // Copila el tipo de letra y la posicion dentro de la burbuja
      info.Surface.DrawStringWrapped(25, ypos +15, info.Width - 10,   
              eFontFont0, eAlignLeft, info.DialogToRender.GetOptionText(i));
      ypos += GetTextHeight(info.DialogToRender.GetOptionText(i), eFontFont0, info.Width - 10);
    }
    i++;
  }
}
// Codigo para actualizar cada vez que el mouse se posicione encima de las opciones
function dialog_options_repexec(DialogOptionsRenderingInfo *info)
{
  info.ActiveOptionID = 0;
  if (mouse.y < info.Y || mouse.y >= info.Y + info.Height ||
      mouse.x < info.X || mouse.x >= info.X + info.Width)
  {
    return; // Si el mouse esta fuera de los limites de la burbuja
  }

  int i = 1, ypos = 0;
  // Busca la opcion que corresponde cuando el mouse esta encima de la burbuja
  while (i <= info.DialogToRender.OptionCount)
  {
    if (info.DialogToRender.GetOptionState(i) == eOptionOn)
    {
      ypos += GetTextHeight(info.DialogToRender.GetOptionText(i), eFontFont0, info.Width - 10);
      if ((mouse.y - info.Y) < ypos)
      {
        info.ActiveOptionID = i;
        return;
      }
    }
    i++;
  }
}
// Codigo para que cuando haga click en la opcion interactue el dialogo
function dialog_options_mouse_click(DialogOptionsRenderingInfo *info, MouseButton button)
{
  if (info.ActiveOptionID > 0)
    info.RunActiveOption();
}
//------------------------------------------------------------


function cSantiago_Talk()
{
  switch(player)
  {
    case cAle:
    dSantiago1.Start();
    break;
    default:
    break;
  }
}
 // Boton del GUI de las caras que cambia a Ale como personaje principal 
function BCaraAle_OnClick(GUIControl *control, MouseButton button)
{
cAle.SetAsPlayer();
gInventario.BackgroundGraphic = 220;
//gBotonesInventario.BackgroundGraphic = 222;
BCaraAle.NormalGraphic = 212;
BCaraAle.MouseOverGraphic = 213 ;
BCaraSantiago.NormalGraphic = 180;
BCaraSantiago.MouseOverGraphic = 181;
BAbrirInventario.NormalGraphic = 224;
BCerrarInventario.NormalGraphic = 226;


}
 // Boton del GUI de las caras que cambia a Santiago como personaje principal 
function BCaraSantiago_OnClick(GUIControl *control, MouseButton button)
{
cSantiago.SetAsPlayer();
gInventario.BackgroundGraphic = 221;
//gBotonesInventario.BackgroundGraphic = 223;
BCaraSantiago.NormalGraphic = 211;
BCaraSantiago.MouseOverGraphic = 214;
BCaraAle.NormalGraphic = 182;
BCaraAle.MouseOverGraphic = 183;
BAbrirInventario.NormalGraphic = 225;
BCerrarInventario.NormalGraphic = 227;
}
// Codigo para combinar items default
function CombinarItemsDefault () 
{
  Hablar("No se porque haria eso");
}
// Codigo para usar default Generico
function UsarDefault ()
{
  Hablar("No necesito usar esto ahi");
}
//--------------- CODIGO CUANDO SE USAN LOS ITEMS EN SANTIAGO--------------//
function cSantiago_UseInv()
{
switch (player.ActiveInventory)
 {
  case iDestornillador:
      if (player == cSantiago)
      {
        HablarSantiago("Todavia no estoy pensando en suicidarme");
        }
        else
      {
        player.Walk(cSantiago.x + 25,  cSantiago.y + 25, eBlock, eWalkableAreas);
        player.FaceCharacter(cSantiago, eBlock);
        cSantiago.FaceCharacter(player, eBlock);
        Hablar("Agarra el desto, te va servir mejor a vos");
        player.LoseInventory(iDestornillador);
        cSantiago.AddInventory(iDestornillador);
      }
  break;
  case iLibro:
    if (player == cSantiago)
    {
      HablarSantiago("No tengo tiempo para leer esto");
    }
    else
    {
      player.Walk(cSantiago.x + 25,  cSantiago.y + 25, eBlock, eWalkableAreas);
      player.FaceCharacter(cSantiago, eBlock);
      cSantiago.FaceCharacter(player, eBlock);
      Hablar("Te recomiendo que leas este libro");
      HablarSantiago("No gracias, ya tengo suficientes cosas para leer");
    }
    break;
    
    case iControlRemoto:
     if (player == cSantiago)
      {
        }
        else
      {
      player.Walk(cSantiago.x + 25,  cSantiago.y + 25, eBlock, eWalkableAreas);
      player.FaceCharacter(cSantiago, eBlock);
      cSantiago.FaceCharacter(player, eBlock);
      Hablar("Te cedo el mando de la tele");
      Hablar("Un gran poder conlleva una gran responsabilidad");
      cSantiago.AddInventory(iControlRemoto);
      player.LoseInventory(iControlRemoto);
      }
      break;
 case iPilasGastadas: 
  if (player == cSantiago)
      {
        }
        else
      {
        player.Walk(cSantiago.x + 25,  cSantiago.y + 25, eBlock, eWalkableAreas);
      player.FaceCharacter(cSantiago, eBlock);
      cSantiago.FaceCharacter(player, eBlock);
      HablarSantiago("Dame tu basura que yo la guardo");
      cSantiago.AddInventory(iPilasGastadas);
      player.LoseInventory(iPilasGastadas);
      }
      break;
  case iPilasNuevas:
  if (player == cSantiago)
      {
        }
        else
      {
        player.Walk(cSantiago.x + 25,  cSantiago.y + 25, eBlock, eWalkableAreas);
      player.FaceCharacter(cSantiago, eBlock);
      cSantiago.FaceCharacter(player, eBlock);
      HablarSantiago("Bien pilas nuevas siempre son utiles");
      player.LoseInventory(iPilasNuevas);
      cSantiago.AddInventory(iPilasNuevas);
      }
      break;
  case iLibreta: 
    Hablar("Es mi libreta personal");
 Hablar("Prefiero mantenerla conmigo");
 break;
 }
}
 //------------------------------------------------------------
 
 //--------------- CODIGO CUANDO SE USAN LOS ITEMS EN ALE--------------//
function cAle_UseInv()
{
switch (player.ActiveInventory)
 {
  case iDestornillador:
      if (player == cAle)
      {
        HablarAle("No creo que sea una buena idea");
        }
        else
      {
        player.Walk(cAle.x + 25,  cAle.y + 25, eBlock, eWalkableAreas);
        player.FaceCharacter(cAle, eBlock);
        cAle.FaceCharacter(player, eBlock);
        Hablar("No lo pierdas");
        player.LoseInventory(iDestornillador);
        cAle.AddInventory(iDestornillador);
      }
  break;
  case iLibro:
    if (player == cAle)
    {
      HablarAle("Wow que interesante");
    }
    else
    {
      player.Walk(cAle.x + 25,  cAle.y + 25, eBlock, eWalkableAreas);
      player.FaceCharacter(cAle, eBlock);
      cAle.FaceCharacter(player, eBlock);
      Hablar("Te devuelvo tu libro");
      HablarAle("Gracias");
    }
    break;
    
    case iControlRemoto:
     if (player == cAle)
      {
        }
        else
      {
      player.Walk(cAle.x + 25,  cAle.y + 25, eBlock, eWalkableAreas);
      player.FaceCharacter(cAle, eBlock);
      cAle.FaceCharacter(player, eBlock);
      Hablar("Te lo dejo usar por un momento");
      cAle.AddInventory(iControlRemoto);
      player.LoseInventory(iControlRemoto);
      }
      break;
 case iPilasGastadas: 
  if (player == cAle)
      {
        }
        else
      {
        player.Walk(cAle.x + 25,  cAle.y + 25, eBlock, eWalkableAreas);
      player.FaceCharacter(cAle, eBlock);
      cAle.FaceCharacter(player, eBlock);
      HablarAle("Deberiamos tirar estas cosas");
      cAle.AddInventory(iPilasGastadas);
      player.LoseInventory(iPilasGastadas);
      }
      break;
  case iPilasNuevas:
  if (player == cAle)
      {
        }
        else
      {
        player.Walk(cAle.x + 25,  cAle.y + 25, eBlock, eWalkableAreas);
      player.FaceCharacter(cAle, eBlock);
      cAle.FaceCharacter(player, eBlock);
      HablarAle("Estas son las que sirven");
      player.LoseInventory(iPilasNuevas);
      cAle.AddInventory(iPilasNuevas);
      }
      break;
    case iCelular:
    Hablar("¿Te refieres a que se lo tire por la cabeza o a que se lo de?");
    Hablar("De cualquier forma a el no le gustan los celulares");
    break;
 }
}
//----------------------------------------------------------------------
//-------------------------ITEMS----------------------------------------//
// Destornillador----------------------------------
// Si se mira al item destornillador
function iDestornillador_Look()
{
switch (player)
{
  case cAle:  
  Hablar("Creo que es un destornillador");
  Hablar("No se muy bien como se usan estas cosas");
break;
case cSantiago: 
  Hablar("Es un detornillador de punta plana");
  Hablar("En manos de un experto tiene cientos de aplicaciones");
  break;
}
}
// Codigo para uso por default del destornillador
function UsarDestornilladorDefault () 
{
  if (player.ActiveInventory == iDestornillador)
  {
    switch (player)
    {
      case cAle: 
      Hablar("No se como usar esto");
      break;
      case cSantiago:
      Hablar("No hay que desatornillar eso");
      break;
    }
  }
}
// Si se usa el Destornillador con otros items
function iDestornillador_UseInv()
{
 CombinarItemsDefault();
}
// Control Remoto-----------------------------
function iControlRemoto_Look()
{

if (ControlConPilasPuestas == false)
  {
    if (ControlConPilasViejas == true)
    {
      Hablar("Parece ser que tiene las pilas gastadas");
      player.AddInventory(iPilasGastadas);
      ControlConPilasViejas = false;
    }
    else
      {
        Hablar("No tiene pilas por ahora");
      }
  }
else
 {
  Hablar("Esta funcionando con normalidad"); 
}
}
function iControlRemoto_UseInv()
{
switch(player.ActiveInventory)
  {
    case iPilasGastadas:
    Hablar("No tiene sentido que le coloque pilas ya gastadas");
    break;
    case iPilasNuevas:
    Hablar("Listo, el control remoto recupera su poder");
    ControlConPilasPuestas = true;
    player.LoseInventory(iPilasNuevas);
    break;
    default:
    CombinarItemsDefault();
    break;
  }
}

// Pilas Gastadas-------------------------

function iPilasGastadas_UseInv()
{
  switch(player.ActiveInventory)
  {
    case iControlRemoto:
    Hablar("No tiene sentido que le coloque pilas ya gastadas");
    break;
    default:
    CombinarItemsDefault();
    break;
  }
 }

function iPilasGastadas_Look()
{
  Hablar("Un par de pilas que ya cumplieron su funcion");
  Hablar("No son recargables");
}
// Pilas nuevas------------------------
function iPilasNuevas_UseInv()
{

 switch(player.ActiveInventory)
  {
    case iControlRemoto:
    Hablar("Listo, el control remoto recupera su poder");
    ControlConPilasPuestas = true;
    player.LoseInventory(iPilasNuevas);
    break;
    default:
    CombinarItemsDefault();
    break;
  }
}

function iPilasNuevas_Look()
{
  Hablar("Son pilas nuevas que le pertenecian a la radio");
  Hablar("Siempre hay que tener un par a mano");
}
// Libro---------------------------------
function iLibro_UseInv()
{
CombinarItemsDefault();
}

function iLibro_Look()
{
Hablar("Uff podria estar 2 horas leyendo");
Hablar("Basicamente se trata de buscar la forma de invocar a un demonio");
Hablar("Para eso se utiliza un libro de hechizos llamado Necronomicon");
Hablar("Lo curioso, es que se dice que hay un ejemplar del grimorio en la UBA");
}
// Factura---------------------------------
function iFactura_UseInv()
{
CombinarItemsDefault();
}

function iFactura_Look()
{
Hablar("Es del mes pasado de GenericTVComp");
Hablar("Ya la pagamos, pero creo que no informamos el pago");
Hablar("El numero es 0810-1912");
}


// Libreta---------------------------------------------
function iLibreta_Look()
{
// Muestra el GUI de la libreta
gLibreta.Visible = true;
gSalirDeLibreta.Visible = true;
}
// Cierra el GUI de la libreta
function gSalirDeLibreta_OnClick(GUI *theGui, MouseButton button)
{
gLibreta.Visible = false;
gSalirDeLibreta.Visible = false;
}

function iLibreta_UseInv()
{
CombinarItemsDefault();
}
// Camara------------------------------------------

function iCamara_Look()
{
switch(player)
  {
    case cAle:
  Hablar("Es la camara instantanea de Santiago");
  Hablar("Le falta rollo");
    break;
    case cSantiago:
    Hablar("Es mi camara instantanea");
     Hablar("Le falta rollo");
    break;
  }
}

function iCamara_UseInv()
{
switch(player.ActiveInventory)
  {
    case iCartucho:
    Hablar("Cartucho + camara = poder ilimitado");
    CamaraConCartucho = true;
    player.LoseInventory(iCartucho);
    break;
    default:
    CombinarItemsDefault();
    break;
  }
}
 
// Cartucho-----------------------------------

function iCartucho_Look()
{
Hablar("10 fotos listas para usar");
}

function iCartucho_UseInv()
{
switch (player.ActiveInventory)
{
  case iCamara:
  Hablar("Cartucho + camara = poder ilimitado");
  CamaraConCartucho = true;
  player.LoseInventory(iCartucho);
  break;
  default:
  CombinarItemsDefault();
  break;
}

}

// Celular------------------------------

function iCelular_Look()
{
  if (player.x <= Room.Width - 200 )  // Si el personaje esta parado cerca del borde derecho
  {
    mouse.Mode = eModePointer;
gSalirDelCelular.Visible = true;
gCelular.Visible = true;
  
  }
  else
  {
    mouse.Mode = eModePointer;
   player.FaceDirection(eDirectionLeft, eBlock);
gSalirDelCelular.Visible = true;
gCelular.Visible = true;   
  }
}
//------------------------------------------------------------// 

function cAle_Talk()
{
dAle1.Start();
}


//--------------CODIGO PARA HABLAR POR CELULAR----------------------


// Si marca un numero 1 
function BNumero1_OnClick(GUIControl *control, MouseButton button)
{
  if (CharlandoPorCelu == true)  
  { 
     if (LPantallaCelu.Text == "3")
      {
        LPantallaCelu.Text = LPantallaCelu.Text.Append("1");
        dFactura.Start();
        }
         if ((LPantallaCelu.Text == "4" || LPantallaCelu.Text == "41" || LPantallaCelu.Text == "411" || LPantallaCelu.Text == "4111") )
      {
        LPantallaCelu.Text = LPantallaCelu.Text.Append("1");
        dFactura.Start();
        }
      if (LPantallaCelu.Text == "1? o 2? o 3? o 4?")
          {
            LPantallaCelu.Text = "1";
            dFactura.Start();
          }
  }
  else
  {
    if (LPantallaCelu.Text == "numero?") // Si la pantalla esta en "numero?" borra el texto y pone el 1
       {
       LPantallaCelu.Text = "";
       LPantallaCelu.Text = LPantallaCelu.Text.Append("1"); 
       }
       else
       {
          LPantallaCelu.Text = LPantallaCelu.Text.Append("1"); 
         }
  }
}

// Si marca un numero 2 
function BNumero2_OnClick(GUIControl *control, MouseButton button)
{
   if (CharlandoPorCelu == true)  
  { 
     if (LPantallaCelu.Text == "3")
      {
        LPantallaCelu.Text = LPantallaCelu.Text.Append("2");
        dFactura.Start();
        }
         if ((LPantallaCelu.Text == "4" || LPantallaCelu.Text == "41" || LPantallaCelu.Text == "411" || LPantallaCelu.Text == "4111") )
      {
        LPantallaCelu.Text = "32";
        dFactura.Start();
        }
      if (LPantallaCelu.Text == "1? o 2? o 3? o 4?")
          {
            LPantallaCelu.Text = "2";
            dFactura.Start();
          }
  }
  else
  {
    if (LPantallaCelu.Text == "numero?")
       {
       LPantallaCelu.Text = "";
       LPantallaCelu.Text = LPantallaCelu.Text.Append("2"); 
       }
       else
       {
          LPantallaCelu.Text = LPantallaCelu.Text.Append("2"); 
         }
  }
}

// Si marca un numero 3 
function BNumero3_OnClick(GUIControl *control, MouseButton button)
{
  if (CharlandoPorCelu == true)  
  { 
       if ( LPantallaCelu.Text == "4111")
       {
         LPantallaCelu.Text = "32";
        dFactura.Start();
       }
      if (LPantallaCelu.Text == "1? o 2? o 3? o 4?")
          {
            LPantallaCelu.Text = "3";
            dFactura.Start();
          }
  }
  else
  {
     if (LPantallaCelu.Text == "numero?")
         {
         LPantallaCelu.Text = "";
         LPantallaCelu.Text = LPantallaCelu.Text.Append("3"); 
         }
         else
         {
            LPantallaCelu.Text = LPantallaCelu.Text.Append("3"); 
           }
  }
}

// Si marca un numero 4 
function BNumero4_OnClick(GUIControl *control, MouseButton button)
{
    if (CharlandoPorCelu == true)  
  { 
      if ( LPantallaCelu.Text == "4111")
       {
         LPantallaCelu.Text = "32";
        dFactura.Start();
       }
       
      if (LPantallaCelu.Text == "1? o 2? o 3? o 4?")
          {
            LPantallaCelu.Text = "4";
            dFactura.Start();
          }
  }
  else
  {
 if (LPantallaCelu.Text == "numero?")
     {
     LPantallaCelu.Text = "";
     LPantallaCelu.Text = LPantallaCelu.Text.Append("4"); 
     }
     else
     {
        LPantallaCelu.Text = LPantallaCelu.Text.Append("4"); 
       }
  }
}

// Si marca un numero 5 
function BNumero5_OnClick(GUIControl *control, MouseButton button)
{
   if (CharlandoPorCelu == true)  
  { 
      if ( LPantallaCelu.Text == "4111")
       {
         LPantallaCelu.Text = "32";
        dFactura.Start();
       }
  }    
       else
       {
      if (LPantallaCelu.Text == "numero?")
     {
     LPantallaCelu.Text = "";
     LPantallaCelu.Text = LPantallaCelu.Text.Append("5"); 
     }
     else
     {
        LPantallaCelu.Text = LPantallaCelu.Text.Append("5"); 
     }
   }
 }

// Si marca un numero 6 
function BNumero6_OnClick(GUIControl *control, MouseButton button)
{
   if (CharlandoPorCelu == true)  
  { 
      if ( LPantallaCelu.Text == "4111")
       {
         LPantallaCelu.Text = "32";
        dFactura.Start();
       }
  }    
       else
       {
 if (LPantallaCelu.Text == "numero?")
     {
     LPantallaCelu.Text = "";
     LPantallaCelu.Text = LPantallaCelu.Text.Append("6"); 
     }
     else
     {
        LPantallaCelu.Text = LPantallaCelu.Text.Append("6"); 
       }
       }
}

// Si marca un numero 7 
function BNumero7_OnClick(GUIControl *control, MouseButton button)
{
   if (CharlandoPorCelu == true)  
  { 
      if ( LPantallaCelu.Text == "4111")
       {
         LPantallaCelu.Text = "32";
        dFactura.Start();
       }
  }    
       else
       {
 if (LPantallaCelu.Text == "numero?")
     {
     LPantallaCelu.Text = "";
     LPantallaCelu.Text = LPantallaCelu.Text.Append("7"); 
     }
     else
     {
        LPantallaCelu.Text = LPantallaCelu.Text.Append("7"); 
       }
       }
}

// Si marca un numero 8 
function BNumero8_OnClick(GUIControl *control, MouseButton button)
{
   if (CharlandoPorCelu == true)  
  { 
      if ( LPantallaCelu.Text == "4111")
       {
         LPantallaCelu.Text = "32";
        dFactura.Start();
       }
  }    
       else
       {
 if (LPantallaCelu.Text == "numero?")
     {
     LPantallaCelu.Text = "";
     LPantallaCelu.Text = LPantallaCelu.Text.Append("8"); 
     }
     else
     {
        LPantallaCelu.Text = LPantallaCelu.Text.Append("8"); 
       }
       }
}

// Si marca un numero 9 
function BNumero9_OnClick(GUIControl *control, MouseButton button)
{
   if (CharlandoPorCelu == true)  
  { 
      if ( LPantallaCelu.Text == "4111")
       {
         LPantallaCelu.Text = "32";
        dFactura.Start();
       }
  }    
       else
       {
if (LPantallaCelu.Text == "numero?")
     {
     LPantallaCelu.Text = "";
     LPantallaCelu.Text = LPantallaCelu.Text.Append("9"); 
     }
     else
     {
        LPantallaCelu.Text = LPantallaCelu.Text.Append("9"); 
       }
       }
}

// Si marca asterisco
function BAsterisco_OnClick(GUIControl *control, MouseButton button)
{
   if (CharlandoPorCelu == true)  
  { 
      if ( LPantallaCelu.Text == "4111")
       {
         LPantallaCelu.Text = "32";
        dFactura.Start();
       }
  }     
       else
       {
if (LPantallaCelu.Text == "numero?")
     {
     LPantallaCelu.Text = "";
     LPantallaCelu.Text = LPantallaCelu.Text.Append("*"); 
     }
     else
     {
        LPantallaCelu.Text = LPantallaCelu.Text.Append("*"); 
       }
       }
}

// Si marca un numero 0
function BNumero0_OnClick(GUIControl *control, MouseButton button)
{
   if (CharlandoPorCelu == true)  
  { 
      if ( LPantallaCelu.Text == "4111")
       {
         LPantallaCelu.Text = "32";
        dFactura.Start();
       }
  }     
       else
       {
if (LPantallaCelu.Text == "numero?")
     {
     LPantallaCelu.Text = "";
     LPantallaCelu.Text = LPantallaCelu.Text.Append("0"); 
     }
     else
     {
        LPantallaCelu.Text = LPantallaCelu.Text.Append("0"); 
       }
       }
}

// Si marca hashtag
function BHashtag_OnClick(GUIControl *control, MouseButton button)
{
   if (CharlandoPorCelu == true)  
  { 
      if ( LPantallaCelu.Text == "4111")
       {
         LPantallaCelu.Text = "32";
        dFactura.Start();
       }
  }    
       else
       {
if (LPantallaCelu.Text == "numero?")
     {
     LPantallaCelu.Text = "";
     LPantallaCelu.Text = LPantallaCelu.Text.Append("#"); 
     }
     else
     {
        LPantallaCelu.Text = LPantallaCelu.Text.Append("#"); 
       }
       }
}

// Si marca cancelar
function BCancelar_OnClick(GUIControl *control, MouseButton button)
{
  if (CharlandoPorCelu == true)
  {
    CharlandoPorCelu = false;
     LPantallaCelu.Text = "numero?";
  }
  else
  {
      if (LPantallaCelu.Text == "numero?")
       {
       
       }
       else
       {
          LPantallaCelu.Text = "numero?";
         }
  }
}

// Si marca el boton del medio
function BNada_OnClick(GUIControl *control, MouseButton button)
{
 if (CharlandoPorCelu == true)  
  { 
      if ( LPantallaCelu.Text == "4111")
       {
         LPantallaCelu.Text = "32";
        dFactura.Start();
       }
  }     
       else
       {  
LPantallaCelu.Text = "¿Duro y resistente?";  
Wait(80);
LPantallaCelu.Text = "¿Bateria ilimitada?";
Wait(80);
LPantallaCelu.Text = "     ¡Mokya    1100!   ";
Wait(80);
LPantallaCelu.Text = "Gracias por elegirnos";
Wait(40);
LPantallaCelu.Text = "........Error 404........";
Wait(40);
LPantallaCelu.Text = "numero?";
       }
}

// Si marca la linterna
function BLinterna_OnClick(GUIControl *control, MouseButton button)
{
Hablar("No hace falta que prenda la linterna en estos momentos");
}

// Si marca el boton de llamar
function BLlamar_OnClick(GUIControl *control, MouseButton button)
{
   if (CharlandoPorCelu == true)  
  { 
      if ( LPantallaCelu.Text == "4111")
       {
         LPantallaCelu.Text = "32";
        dFactura.Start();
       }
  }    
       else
       {
          cCosa.ChangeRoom(player.Room);
        switch (LPantallaCelu.Text)
        {
          case "0":
           gCelular.Visible = false;
        gSalirDelCelular.Visible = false;
        CharlandoPorCelu = true;
        Hablar("Whats up!");
        HablarCosa("Quien es?");
        Hablar("Bujaja funciona!");
        if (player.Loop == 1)       // Si mira a la izquierda
                  {
                    player.Animate(3, 5, eOnce, eBlock, eForwards);  // Animacion para guardar el celular izq
                  }
                  else
                  {
                    player.Animate(2, 5, eOnce, eBlock, eForwards); // Animacion para guardar el celular dere
                  }
        player.UnlockView();
        CharlandoPorCelu = false;
        LPantallaCelu.Text = "numero?";
          break;
            case "":
           gCelular.Visible = false;
        gSalirDelCelular.Visible = false;
          
         
          break;
            case "08101912":
            player.LockViewFrame(16, 0,0);
           gCelular.Visible = false;
        gSalirDelCelular.Visible = false;
        CharlandoPorCelu = true;
          dFactura.Start();
          
          break;
          
          default:
          gCelular.Visible = false;
        gSalirDelCelular.Visible = false;
        player.LockViewFrame(16, 0,0);
         CharlandoPorCelu = true;
        HablarCosa("El numero que usted marco no está disponible");
        if (player.Loop == 1)       // Si mira a la izquierda
                  {
                    player.Animate(3, 5, eOnce, eBlock, eForwards);  // Animacion para guardar el celular izq
                  }
                  else
                  {
                    player.Animate(2, 5, eOnce, eBlock, eForwards); // Animacion para guardar el celular dere
                  }
        player.UnlockView();
        CharlandoPorCelu = false;
        LPantallaCelu.Text = "numero?";
         
        }
        }
}

// GUI para salir del GUI del celular
function gSalirDelCelular_OnClick(GUI *theGui, MouseButton button)
{
gCelular.Visible = false;
gSalirDelCelular.Visible = false;
}
//---------------------------------------------------------------------------//